<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>TRANG QUẢN TRỊ SPARK</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/static/css2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/css2/css/dataTables.bootstrap4.min.css">
    <!-- Typography CSS -->
    <link rel="stylesheet" href="/static/css2/css/typography.css">
    <!-- Style CSS -->
    <link rel="stylesheet" href="/static/css2/css/style1.css">
    <!-- Responsive CSS -->
    <link rel="stylesheet" href="/static/css2/css/responsive.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

</head>

<body>
    <!-------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <!-- Wrapper Start -->
    <div class="wrapper">
        <!-- Sidebar  -->
        <div class="iq-sidebar">
            <div class="iq-sidebar-logo d-flex justify-content-between">
                <a id="manage" asp-area="Admin" asp-controller="Manager" asp-action="Index" class="header-logo">
                    <img src="../../assets/images/logo.png" class="img-fluid rounded-normal" alt="">
                    <div class="logo-title">
                        <span class="text-primary text-uppercase">SPARK</span>
                    </div>
                </a>
                <div class="iq-menu-bt-sidebar">
                    <div class="iq-menu-bt align-self-center">
                        <div class="wrapper-menu">
                            <div class="main-circle">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="sidebar-scrollbar" style="margin-top: 60px;">
                <hr />
                <nav class="iq-sidebar-menu">
                    
                    <ul id="iq-sidebar-toggle" class="iq-menu">
                        <li><a id="manage" href="http://localhost/webbangiay/frontEnd/admin/views/shoemanager/index.php">
                               
                            <i class="fa-solid fa-shoe-prints"></i> 
                            Danh sách thú cưng</a>
                        </li>
                       
                        <li><a id="manage" href="http://localhost/webbangiay/frontEnd/admin/views/type/types.php">
                            <i class="fa-solid fa-tags"></i> 
                            Danh Sách Loại</a>
                        </li>
                      
                        <li><a id="manage" asp-area="Admin" asp-controller="User" asp-action="Index">
                                <i class="fa-solid fa-user"></i>
                                Tài khoản</a>
                        </li>
                        <li><a id="manage" asp-area="Admin" asp-controller="OrderManagement" asp-action="ManageOrders">
                                <i class="fa-solid fa-box"></i>
                                Đơn hàng</a>
                        </li>
                    </ul>
                </nav>
                <div id="sidebar-bottom" class="p-3 position-relative">
                    <div class="iq-card">
                        <div class="iq-card-body">
                            <div class="sidebar-bottom-content">
                                <a class="btn w-100 btn-primary mt-4 view-more" href="http://localhost/webbangiay/frontEnd/views/index.php">
                                    <i class="fa-solid fa-home"></i>
                                    Trang chủ
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-------------------------------------------------------------------------------------------------------------------------------------------------------------->
        <!-- TOP Nav Bar -->
        <div class="iq-top-navbar">
            <div class="iq-navbar-custom">
                <nav class="navbar navbar-expand-lg navbar-light p-0">
                    <div class="iq-menu-bt d-flex align-items-center">
                        <div class="wrapper-menu">
                            <div class="main-circle"><i class="fa-solid fa-bars"></i></div>
                        </div>
                        <div class="iq-navbar-logo d-flex justify-content-between">
                            <a href="index.html" class="header-logo">
                                <img src="../../assets/images/logo.png" class="img-fluid rounded-normal" alt="">
                                <div class="logo-title">
                                    <span class="text-primary text-uppercase">SPARK</span>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="navbar-breadcrumb">
                        <h5 class="mb-0">TRANG QUẢN LÝ</h5>
                    </div>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-label="Toggle navigation">
                        <i class="ri-menu-3-line"></i>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ml-auto navbar-list">
                            <li>
                                
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>

    <!-------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <!-- CONTENT -->
    <div id="content-page" class="content-page">
        <div class="container-fluid">
            <div class="iq-card iq-card-block iq-card-stretch iq-card-height">
                <div class="iq-card-body">
<h1 class="text-center mb-4">Thêm thú cưng Mới</h1>

<hr />

<div class="row">
    <div class="col-md-10 mx-auto">
        <form id="pet-form" method="post" enctype="multipart/form-data">
            <div class="text-danger mb-4" id="validation-summary"></div>

            <div class="row">
                <!-- Cột trái -->
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        <label for="name" class="control-label">Tên thú cưng</label>
                        <input id="name" name="name" class="form-control" required>
                        <span id="title-validation" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label for="categoryId" class="control-label">Thể Loại</label>
                        <select id="categoryId" name="categoryId" class="form-control" required>
                            <!-- Options sẽ được thêm thông qua API -->
                        </select>
                        <span id="category-validation" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label for="description" class="control-label">Miêu tả</label>
                        <textarea id="description" name="description" class="form-control" required></textarea>
                        <span id="description-validation" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label for="price" class="control-label">Giá</label>
                        <input id="price" name="price" type="number" class="form-control" required>
                        <span id="price-validation" class="text-danger"></span>
                    </div>
                </div>

                <!-- Cột phải -->
                <div class="col-md-6">
                    <div class="form-group mb-3">
                        <label for="age" class="control-label">Tuổi</label>
                        <input id="age" name="age" type="number" class="form-control" required>
                        <span id="price-validation" class="text-danger"></span>
                    </div><div class="form-group mb-3">
                        <label for="stock" class="control-label">Hàng tồn</label>
                        <input id="stock" name="stock" type="number" class="form-control" required>
                        <span id="price-validation" class="text-danger"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label for="breed" class="control-label">Giống vật nuôi</label>
                        <input id="breed" name="breed" class="form-control" required>
                        <span id="title-validation" class="text-danger"></span>
                    </div>
                    
                    <div class="form-group mb-3">
                        <label for="image" class="control-label">Hình ảnh</label>
                        <input id="image" name="image" class="form-control" required>
                        <span id="title-validation" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <!-- Nút hành động -->
            <div class="text-center mt-4">
                <input type="submit" value="Thêm" class="btn btn-success btn-lg" />
                <a href="index.php" class="btn btn-secondary btn-lg ml-3">Quay về danh sách</a>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> 
<script>
    $(document).ready(function () {
        // Lấy danh sách thể loại từ API
       $.get('http://localhost:3001/api/category-list', function (data) {
    // Lấy danh sách categories từ response
    data.categories.forEach(category => {
        $('#categoryId').append(`<option value="${category._id}">${category.name}</option>`);
    });
});


        // Gửi dữ liệu form lên server qua AJAX
        $("#pet-form").submit(function (e) {
            e.preventDefault();  // Ngừng hành động mặc định của form

            let formData = new FormData(this);

            // Gửi yêu cầu POST lên API
            $.ajax({
                url: "http://localhost:3001/api/insert-pet", // API thêm thú cưng
                method: "POST",
                data: formData,
                processData: false,  // Không xử lý dữ liệu tự động
                contentType: false,  // Không tự động đặt content-type
                success: function (response) {
                    alert("Thêm thú cưng thành công!");
                    window.location.href = "index.php";  // Quay về trang danh sách
                },
                error: function (xhr) {
                    console.error("Lỗi khi thêm thú cưng:", xhr.responseText);
                    alert("Có lỗi xảy ra khi thêm thú cưng!");
                }
            });
        });
    });
</script>